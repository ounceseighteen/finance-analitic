<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>üìã –ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</h1>

        <div class="nav-links">
            <a href="{{ url_for('index') }}">–ì–ª–∞–≤–Ω–∞—è</a>
            <a href="{{ url_for('add_transaction') }}">–î–æ–±–∞–≤–∏—Ç—å</a>
            <a href="{{ url_for('history') }}" class="active">–ò—Å—Ç–æ—Ä–∏—è</a>
            <a href="{{ url_for('import_export') }}">–ò–º–ø–æ—Ä—Ç/–≠–∫—Å–ø–æ—Ä—Ç</a>
            <span style="margin-left: auto; color: #333;">
                –ü—Ä–∏–≤–µ—Ç, {{ session.username }}!
            </span>
            <a href="{{ url_for('logout') }}" style="color: #dc3545;">–í—ã–π—Ç–∏</a>
        </div>

        {% if transactions %}
        <div class="card">
            <table class="transactions-table">
                <thead>
                    <tr>
                        <th>–î–∞—Ç–∞</th>
                        <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                        <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                        <th>–°—É–º–º–∞</th>
                        <th>–ë–∞–ª–∞–Ω—Å –ø–æ—Å–ª–µ</th>
                        <th>–î–µ–π—Å—Ç–≤–∏–µ</th>
                    </tr>
                </thead>
                <tbody>
                    {% for t in transactions %}
                    <tr class="transaction-{{ t.type }}">
                        <td>
                            {% set date_parts = t.date.split('-') %}
                            {% if date_parts|length == 3 %}
                                {{ date_parts[2] }}.{{ date_parts[1] }}.{{ date_parts[0] }}
                            {% else %}
                                {{ t.date }}
                            {% endif %}
                        </td>
                        <td>{{ t.category }}</td>
                        <td>{{ t.description or '-' }}</td>
                        <td class="amount {% if t.type == 'income' %}positive{% else %}negative{% endif %}">
                            {{ t.sign }}{{ "%.2f"|format(t.amount) }} ‚ÇΩ
                        </td>
                        <td class="amount {% if t.balance_after >= 0 %}positive{% else %}negative{% endif %}">
                            {{ "%.2f"|format(t.balance_after) }} ‚ÇΩ
                        </td>
                        <td>
                            <a href="{{ url_for('delete_transaction', transaction_id=t.id) }}"
                               class="delete-link"
                               onclick="return confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –æ–ø–µ—Ä–∞—Ü–∏—é?')">
                                –£–¥–∞–ª–∏—Ç—å
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="card">
            <p style="text-align: center; color: #666;">–ü–æ–∫–∞ –Ω–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π</p>
        </div>
        {% endif %}
    </div>
</body>
</html>
